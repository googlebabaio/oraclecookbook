
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>索引碎片分析与整理 · 中年人的Oracle枸杞</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="suredandan">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="query-yincang-parameter.html" />
    
    
    <link rel="prev" href="37.表碎片分析.html" />
    

    
        <link rel="shortcut icon" href='../favicon.ico' type="image/x-icon">
    
    
        <link rel="bookmark" href='../favicon.ico' type="image/x-icon">
    
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../install/安装篇.md">
            
                <span>
            
                    
                        <b>1.2.</b>
                    
                    安装篇
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../install/1.11gsingleasm.html">
            
                <a href="../install/1.11gsingleasm.html">
            
                    
                        <b>1.2.1.</b>
                    
                    11g单机安装asm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../rac/5.11gRAC-intsall.html">
            
                <a href="../rac/5.11gRAC-intsall.html">
            
                    
                        <b>1.2.2.</b>
                    
                    11gRAC安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../install/26.apply-psu.html">
            
                <a href="../install/26.apply-psu.html">
            
                    
                        <b>1.2.3.</b>
                    
                    RAC环境打PSU补丁步骤
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../dataguard/2.11g-single-asm-dg.html">
            
                <a href="../dataguard/2.11g-single-asm-dg.html">
            
                    
                        <b>1.2.4.</b>
                    
                    11g单机环境下配置基于asm的dg
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../dataguard/3.11g-multinode-dg.html">
            
                <a href="../dataguard/3.11g-multinode-dg.html">
            
                    
                        <b>1.2.5.</b>
                    
                    采用broker配置11g多节点dataguard(>=3节点)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../dataguard/4.11g-doublerac-dg.html">
            
                <a href="../dataguard/4.11g-doublerac-dg.html">
            
                    
                        <b>1.2.6.</b>
                    
                    采用备份复制的方式搭建11grac到rac的adg
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../dataguard/rac2rac-dg-duplicate-spfile.html">
            
                <a href="../dataguard/rac2rac-dg-duplicate-spfile.html">
            
                    
                        <b>1.2.7.</b>
                    
                    使用duplicate原生在线搭建11grac到rac的adg
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../rac/RAC.md">
            
                <span>
            
                    
                        <b>1.3.</b>
                    
                    RAC篇
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../rac/5.11gRAC-intsall.html">
            
                <a href="../rac/5.11gRAC-intsall.html">
            
                    
                        <b>1.3.1.</b>
                    
                    11gRAC安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../rac/14.11gRAC-backend-process.html">
            
                <a href="../rac/14.11gRAC-backend-process.html">
            
                    
                        <b>1.3.2.</b>
                    
                    11gRAC进程详解
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../rac/8.11gR2RAC-option-intro.html">
            
                <a href="../rac/8.11gR2RAC-option-intro.html">
            
                    
                        <b>1.3.3.</b>
                    
                    11gR2 RAC各组件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../rac/crs-has-cluster.html">
            
                <a href="../rac/crs-has-cluster.html">
            
                    
                        <b>1.3.4.</b>
                    
                    crs-has-cluster的关系
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../rac/35.HAIP介绍.html">
            
                <a href="../rac/35.HAIP介绍.html">
            
                    
                        <b>1.3.5.</b>
                    
                    HAIP介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../rac/12.RAC-log-infra.html">
            
                <a href="../rac/12.RAC-log-infra.html">
            
                    
                        <b>1.3.6.</b>
                    
                    RAC环境的日志体系
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../rac/10g-rac-command.html">
            
                <a href="../rac/10g-rac-command.html">
            
                    
                        <b>1.3.7.</b>
                    
                    10gRAC命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../rac/9.rac-commnd-intro.html">
            
                <a href="../rac/9.rac-commnd-intro.html">
            
                    
                        <b>1.3.8.</b>
                    
                    11gRAC常用命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../rac/10.11gRAC-10gRAC.html">
            
                <a href="../rac/10.11gRAC-10gRAC.html">
            
                    
                        <b>1.3.9.</b>
                    
                    11gRAC对比10gRAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../rac/34.11gRAC的监听介绍.html">
            
                <a href="../rac/34.11gRAC的监听介绍.html">
            
                    
                        <b>1.3.10.</b>
                    
                    11gRAC的监听介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../rac/36.11gR2RAC修改监听默认端口.html">
            
                <a href="../rac/36.11gR2RAC修改监听默认端口.html">
            
                    
                        <b>1.3.11.</b>
                    
                    11gR2RAC修改监听默认端口
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="../rac/11.asm-commnd-intro.html">
            
                <a href="../rac/11.asm-commnd-intro.html">
            
                    
                        <b>1.3.12.</b>
                    
                    asm常用命令
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../datauard/datauard.md">
            
                <span>
            
                    
                        <b>1.4.</b>
                    
                    Dataguard篇
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../dataguard/2.11g-single-asm-dg.html">
            
                <a href="../dataguard/2.11g-single-asm-dg.html">
            
                    
                        <b>1.4.1.</b>
                    
                    11g单机环境下配置基于asm的dg
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../dataguard/3.11g-multinode-dg.html">
            
                <a href="../dataguard/3.11g-multinode-dg.html">
            
                    
                        <b>1.4.2.</b>
                    
                    采用broker配置11g多节点dataguard(>=3节点)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../dataguard/4.11g-doublerac-dg.html">
            
                <a href="../dataguard/4.11g-doublerac-dg.html">
            
                    
                        <b>1.4.3.</b>
                    
                    采用备份复制的方式搭建11grac到rac的adg
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../dataguard/rac2rac-dg-duplicate-spfile.html">
            
                <a href="../dataguard/rac2rac-dg-duplicate-spfile.html">
            
                    
                        <b>1.4.4.</b>
                    
                    使用duplicate原生在线搭建11grac到rac的adg
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../dataguard/17.case-dg-nosync-troubleshooting.html">
            
                <a href="../dataguard/17.case-dg-nosync-troubleshooting.html">
            
                    
                        <b>1.4.5.</b>
                    
                    解决一起较复杂dg不同步的问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../dataguard/16.dg-nosync-troubleshooting.html">
            
                <a href="../dataguard/16.dg-nosync-troubleshooting.html">
            
                    
                        <b>1.4.6.</b>
                    
                    DG不同步诊断方法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="解决ORA-01152_ORA-10458_ORA-01110.html">
            
                <a href="解决ORA-01152_ORA-10458_ORA-01110.html">
            
                    
                        <b>1.4.7.</b>
                    
                    解决ORA-01152(ORA-10458、ORA-01110)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../dataguard/39.dg-switchov-failover.html">
            
                <a href="../dataguard/39.dg-switchov-failover.html">
            
                    
                        <b>1.4.8.</b>
                    
                    ADG切换过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../dataguard/13.dg-parameters.html">
            
                <a href="../dataguard/13.dg-parameters.html">
            
                    
                        <b>1.4.9.</b>
                    
                    dataguard概念参数查漏补缺
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../dataguard/解决error-1033的问题.md">
            
                <span>
            
                    
                        <b>1.4.10.</b>
                    
                    解决主库报错error-1033的问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../dataguard/给主备环境新添加redo.html">
            
                <a href="../dataguard/给主备环境新添加redo.html">
            
                    
                        <b>1.4.11.</b>
                    
                    给主备环境新添加redo的注意事项和步骤
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../base/基础.md">
            
                <span>
            
                    
                        <b>1.5.</b>
                    
                    基础知识
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../base/18-Oracle-index-unusable-disable-enable.html">
            
                <a href="../base/18-Oracle-index-unusable-disable-enable.html">
            
                    
                        <b>1.5.1.</b>
                    
                    Oracle索引的unusable、disable、enable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../base/7.dbca-option-intro.html">
            
                <a href="../base/7.dbca-option-intro.html">
            
                    
                        <b>1.5.2.</b>
                    
                    Oracle建库时的各组件的用途
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../base/undo的一些说明.html">
            
                <a href="../base/undo的一些说明.html">
            
                    
                        <b>1.5.3.</b>
                    
                    UNDO的一些说明
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                        <b>1.6.</b>
                    
                    备份与恢复篇
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../backup/rman备份中的百分号后面的字母的含义.html">
            
                <a href="../backup/rman备份中的百分号后面的字母的含义.html">
            
                    
                        <b>1.6.1.</b>
                    
                    rman备份中的百分号后面的字母的含义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../backup/rman.html">
            
                <a href="../backup/rman.html">
            
                    
                        <b>1.6.2.</b>
                    
                    利用rman进去备份与恢复
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../backup/rman备份脚本.html">
            
                <a href="../backup/rman备份脚本.html">
            
                    
                        <b>1.6.3.</b>
                    
                    常用rman备份脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../backup/数据泵备份.html">
            
                <a href="../backup/数据泵备份.html">
            
                    
                        <b>1.6.4.</b>
                    
                    常用数据泵备份脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../backup/有数据文件的数据恢复.html">
            
                <a href="../backup/有数据文件的数据恢复.html">
            
                    
                        <b>1.6.5.</b>
                    
                    记录一次有数据文件的数据库恢复
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="运维篇.md">
            
                <span>
            
                    
                        <b>1.7.</b>
                    
                    运维篇
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="27.alter-database-archivelog.html">
            
                <a href="27.alter-database-archivelog.html">
            
                    
                        <b>1.7.1.</b>
                    
                    修改数据库实例到归档模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../dataguard/6.multialive-qianyi.html">
            
                <a href="../dataguard/6.multialive-qianyi.html">
            
                    
                        <b>1.7.2.</b>
                    
                    双活及迁移的一些事
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="20.awr-workhouse-intro.html">
            
                <a href="20.awr-workhouse-intro.html">
            
                    
                        <b>1.7.3.</b>
                    
                    awr仓库的运维
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="24.slove-error-1089.html">
            
                <a href="24.slove-error-1089.html">
            
                    
                        <b>1.7.4.</b>
                    
                    处理一个error-1089问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="23.oracle-startup-auto.html">
            
                <a href="23.oracle-startup-auto.html">
            
                    
                        <b>1.7.5.</b>
                    
                    设置Oracle开机自启动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="25.where-is-alert.html">
            
                <a href="25.where-is-alert.html">
            
                    
                        <b>1.7.6.</b>
                    
                    日志的位置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="29.manage-user.html">
            
                <a href="29.manage-user.html">
            
                    
                        <b>1.7.7.</b>
                    
                    用户管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="28.create-user-profile.html">
            
                <a href="28.create-user-profile.html">
            
                    
                        <b>1.7.8.</b>
                    
                    给用户创建profile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="30.解决ora-16597.html">
            
                <a href="30.解决ora-16597.html">
            
                    
                        <b>1.7.9.</b>
                    
                    解决ora-16597
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="33.解决ora-29780.html">
            
                <a href="33.解决ora-29780.html">
            
                    
                        <b>1.7.10.</b>
                    
                    解决ora-29780
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11" data-path="解决ORA-00206.html">
            
                <a href="解决ORA-00206.html">
            
                    
                        <b>1.7.11.</b>
                    
                    解决ora-00206
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.12" data-path="19.ora-13516O-cannot-collect-awr.html">
            
                <a href="19.ora-13516O-cannot-collect-awr.html">
            
                    
                        <b>1.7.12.</b>
                    
                    解决ora-13516 Oracle无法收集AWR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.13" data-path="解决ORA-01152(ORA-10458、ORA-01110">
            
                <span>
            
                    
                        <b>1.7.13.</b>
                    
                    解决ORA-01152(ORA-10458、ORA-01110)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.14" data-path="解决ORA-01105，ORA-01606.html">
            
                <a href="解决ORA-01105，ORA-01606.html">
            
                    
                        <b>1.7.14.</b>
                    
                    解决ORA-01105，ORA-01606
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.15" data-path="37.表碎片分析.html">
            
                <a href="37.表碎片分析.html">
            
                    
                        <b>1.7.15.</b>
                    
                    表碎片分析与整理
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.7.16" data-path="38.索引碎片分析.html">
            
                <a href="38.索引碎片分析.html">
            
                    
                        <b>1.7.16.</b>
                    
                    索引碎片分析与整理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.17" data-path="query-yincang-parameter.html">
            
                <a href="query-yincang-parameter.html">
            
                    
                        <b>1.7.17.</b>
                    
                    查看隐藏参数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.18" data-path="查询锁表的SQL">
            
                <span>
            
                    
                        <b>1.7.18.</b>
                    
                    查询锁表的SQL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../tunning/性能优化篇.md">
            
                <span>
            
                    
                        <b>1.8.</b>
                    
                    性能优化篇
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../tunning/通过AWR计算IOPS和MBPS.md">
            
                <span>
            
                    
                        <b>1.8.1.</b>
                    
                    通过AWR计算IOPS和MBPS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../tunning/15.intro-xxxps.html">
            
                <a href="../tunning/15.intro-xxxps.html">
            
                    
                        <b>1.8.2.</b>
                    
                    XXXPS的概念
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../zaqizaba/杂项篇.md">
            
                <span>
            
                    
                        <b>1.9.</b>
                    
                    杂项篇
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../zaqizaba/21.install-rzsz.html">
            
                <a href="../zaqizaba/21.install-rzsz.html">
            
                    
                        <b>1.9.1.</b>
                    
                    rzsz工具安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../zaqizaba/22.ssh-copy-id-using-not22port.html">
            
                <a href="../zaqizaba/22.ssh-copy-id-using-not22port.html">
            
                    
                        <b>1.9.2.</b>
                    
                    ssh-copy-id使用非22端口
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../qms数据库整改.html">
            
                <a href="../qms数据库整改.html">
            
                    
                        <b>1.9.3.</b>
                    
                    qms数据库整改
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >索引碎片分析与整理</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <!-- toc -->
<ul>
<li><a href="#%E7%B4%A2%E5%BC%95%E9%87%8D%E5%BB%BA%E7%9A%84%E6%96%B9%E6%B3%95%E5%92%8C%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">&#x7D22;&#x5F15;&#x91CD;&#x5EFA;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x6CE8;&#x610F;&#x4E8B;&#x9879;</a><ul>
<li><a href="#%E4%BB%A5%E4%B8%8B%E6%83%85%E5%86%B5%E9%9C%80%E8%A6%81%E9%87%8D%E5%BB%BA%E7%B4%A2%E5%BC%95">&#x4EE5;&#x4E0B;&#x60C5;&#x51B5;&#x9700;&#x8981;&#x91CD;&#x5EFA;&#x7D22;&#x5F15;</a></li>
<li><a href="#%E9%87%8D%E5%BB%BA%E7%B4%A2%E5%BC%95%E7%9A%84%E6%96%B9%E6%B3%95">&#x91CD;&#x5EFA;&#x7D22;&#x5F15;&#x7684;&#x65B9;&#x6CD5;</a><ul>
<li><a href="#%E6%96%B9%E6%B3%951drop--create">&#x65B9;&#x6CD5;1&#xFF1A;drop + create</a></li>
<li><a href="#%E6%96%B9%E6%B3%952alter-index-rebuild">&#x65B9;&#x6CD5;2&#xFF1A;alter index rebuild</a></li>
<li><a href="#%E6%96%B9%E6%B3%953alter-index-rebuild-online">&#x65B9;&#x6CD5;3&#xFF1A;alter index rebuild online</a></li>
<li><a href="#3%E7%A7%8D%E6%96%B9%E6%B3%95%E7%9A%84%E6%80%BB%E7%BB%93">3&#x79CD;&#x65B9;&#x6CD5;&#x7684;&#x603B;&#x7ED3;</a></li>
</ul>
</li>
<li><a href="#%E7%9B%B8%E5%85%B3%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5">&#x76F8;&#x5173;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;</a><ul>
<li><a href="#%E6%9F%A5%E8%AF%A2%E7%B4%A2%E5%BC%95%E7%A2%8E%E7%89%8750%25%E7%9A%84%E8%AF%AD%E5%8F%A5">&#x67E5;&#x8BE2;&#x7D22;&#x5F15;&#x788E;&#x7247;&gt;50%&#x7684;&#x8BED;&#x53E5;</a></li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E7%B4%A2%E5%BC%95%E9%AB%98%E5%BA%A63">&#x67E5;&#x8BE2;&#x7D22;&#x5F15;&#x9AD8;&#x5EA6;&gt;3</a></li>
</ul>
</li>
<li><a href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E4%B8%8E%E6%80%BB%E7%BB%93">&#x6CE8;&#x610F;&#x4E8B;&#x9879;&#x4E0E;&#x603B;&#x7ED3;</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3">&#x53C2;&#x8003;&#x6587;&#x6863;</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h1 id="&#x7D22;&#x5F15;&#x91CD;&#x5EFA;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x6CE8;&#x610F;&#x4E8B;&#x9879;">&#x7D22;&#x5F15;&#x91CD;&#x5EFA;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x6CE8;&#x610F;&#x4E8B;&#x9879;</h1>
<p><img src="../images/markdown-img-paste-20190114163044795.png" alt=""></p>
<h2 id="&#x4EE5;&#x4E0B;&#x60C5;&#x51B5;&#x9700;&#x8981;&#x91CD;&#x5EFA;&#x7D22;&#x5F15;">&#x4EE5;&#x4E0B;&#x60C5;&#x51B5;&#x9700;&#x8981;&#x91CD;&#x5EFA;&#x7D22;&#x5F15;</h2>
<ul>
<li>&#x7D22;&#x5F15;&#x6216;&#x7D22;&#x5F15;&#x5206;&#x533A;&#x56E0;&#x4E3A;&#x4ECB;&#x8D28;&#x6545;&#x969C;&#x635F;&#x574F;&#xFF0C;&#x4F8B;&#x5982;&#x7D22;&#x5F15;&#x6240;&#x5728;&#x8868;&#x7A7A;&#x95F4;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x88AB;&#x8BEF;&#x5220;&#x9664;&#x3002;</li>
<li>&#x7D22;&#x5F15;&#x8BD5;&#x56FE;&#x4E2D;STATUS&#x5217;&#x6807;&#x8BB0;&#x4E3A;UNUSABLE</li>
<li>&#x7D22;&#x5F15;&#x5BF9;&#x5E94;&#x57FA;&#x8868;move&#x5230;&#x65B0;&#x8868;&#x7A7A;&#x95F4;</li>
<li>&#x7D22;&#x5F15;&#x8BA1;&#x5212;&#x8FC1;&#x79FB;&#x5230;&#x65B0;&#x8868;&#x7A7A;&#x95F4;</li>
<li>&#x4FEE;&#x6539;&#x7D22;&#x5F15;&#x7684;&#x67D0;&#x4E9B;&#x5B58;&#x50A8;&#x53C2;&#x6570;</li>
<li>&#x7D22;&#x5F15;&#x9AD8;&#x5EA6;&gt;3&#x6216;&#x8005;&gt;4</li>
<li>&#x7D22;&#x5F15;&#x7684;&#x788E;&#x7247;&#x5316;&gt;75%</li>
</ul>
<h2 id="&#x91CD;&#x5EFA;&#x7D22;&#x5F15;&#x7684;&#x65B9;&#x6CD5;">&#x91CD;&#x5EFA;&#x7D22;&#x5F15;&#x7684;&#x65B9;&#x6CD5;</h2>
<ul>
<li>&#x91CD;&#x65B0;&#x521B;&#x5EFA;<ul>
<li>drop index index_name;</li>
<li>create index index_name;</li>
</ul>
</li>
<li>alter index index_name rebuild;</li>
<li>alter index index_name rebuild online;</li>
</ul>
<h3 id="&#x65B9;&#x6CD5;1&#xFF1A;drop--create">&#x65B9;&#x6CD5;1&#xFF1A;drop + create</h3>
<p>&#x5728;create index&#x8BED;&#x53E5;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x8BDD;&#x4E00;&#x76F4;&#x6301;&#x6709;TM&#x9501; Imode=4&#xFF0C;&#x963B;&#x585E;&#x4E86;&#x5176;&#x4ED6;&#x4F1A;&#x8BDD;&#x589E;&#x5220;&#x6539;&#x7B49;DML&#x8BED;&#x53E5;&#xFF0C;&#x76F4;&#x5230;&#x7D22;&#x5F15;&#x521B;&#x5EFA;&#x5B8C;&#x6210; &#x3002;</p>
<h3 id="&#x65B9;&#x6CD5;2&#xFF1A;alter-index-rebuild">&#x65B9;&#x6CD5;2&#xFF1A;alter index rebuild</h3>
<pre class="language-"><code>When you rebuild an index, you use an existing index as the data source. Creating an index in this manner enables you to change storage characteristics or move to a new tablespace. Rebuilding an index based on an existing data source removes intra-block fragmentation. Compared to dropping the index and using the CREATE INDEX statement, rebuilding an existing index offers better performance.
</code></pre><p>&#x4E0A;&#x9762;&#x7684;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x5F88;&#x660E;&#x786E;&#x7684;&#x8BF4;&#x660E;&#x4E86;rebuild&#x7684;&#x539F;&#x7406;&#xFF0C;&#x4EE5;&#x539F;&#x6709;&#x7D22;&#x5F15;&#x4F5C;&#x4E3A;&#x57FA;&#x7840;&#x8FDB;&#x884C;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#xFF08;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;10046&#x786E;&#x8BA4;&#xFF09;&#xFF0C;&#x4E14;&#x6027;&#x80FD;&#x8981;&#x597D;&#x4E8E;drop&#x7136;&#x540E;&#x91CD;&#x65B0;create&#x6B65;&#x9AA4;&#x3002;</p>
<ul>
<li>rebuild&#x8981;&#x6301;&#x6709;&#x76F8;&#x5173;&#x9501;&#xFF0C;&#x82E5;&#x8868;&#x6709;&#x672A;&#x63D0;&#x4EA4;&#x7684;&#x4E8B;&#x52A1;&#xFF0C;&#x4F1A;&#x62A5;&#x9519;&#xFF0C;&#x56E0;&#x6B64;rebuild&#x524D;&#x8BF7;&#x4FDD;&#x8BC1;&#x6CA1;&#x6709;&#x76F8;&#x5173;&#x4E8B;&#x52A1;&#x3002;</li>
<li>rebuild&#x8BED;&#x53E5;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4F1A;&#x8BDD;&#x4E00;&#x76F4;&#x6301;&#x6709;TM&#x9501;Imode=4&#xFF0C;&#x963B;&#x585E;&#x5176;&#x4ED6;&#x4F1A;&#x8BDD;&#x589E;&#x5220;&#x6539;&#x7B49;DML&#x64CD;&#x4F5C;&#x3002;</li>
<li>rebuild&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x503C;&#x5F97;&#x5173;&#x6CE8;&#x7684;&#x5730;&#x65B9;&#x5C31;&#x662F;&#x7A7A;&#x95F4;&#x95EE;&#x9898;&#xFF0C;Oracle&#x5728;&#x521B;&#x5EFA;&#x65B0;&#x7D22;&#x5F15;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5E76;&#x4E0D;&#x4F1A;&#x5220;&#x9664;&#x65E7;&#x7D22;&#x5F15;&#xFF0C;&#x76F4;&#x81F3;&#x65B0;&#x7D22;&#x5F15;rebuild&#x6210;&#x529F;&#x3002;<ul>
<li>rebuild&#x8FC7;&#x7A0B;&#xFF0C;&#x82E5;&#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x80FD;&#x7528;&#x5230;&#x65E7;&#x7D22;&#x5F15;&#x4F9D;&#x7136;&#x4F1A;&#x7528;&#x65E7;&#x7D22;&#x5F15;&#xFF0C;&#x67E5;&#x8BE2;&#x6548;&#x7387;&#x4E0D;&#x4F1A;&#x56E0;rebuild&#x800C;&#x964D;&#x4F4E;&#x3002;</li>
<li>rebuild&#x65B9;&#x5F0F;&#x521B;&#x5EFA;&#x7D22;&#x5F15;&#x8FC7;&#x7A0B;&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x7A7A;&#x95F2;&#x7A7A;&#x95F4;&#xFF0C;&#x989D;&#x5916;&#x7A7A;&#x95F4;&#x7684;&#x5927;&#x5C0F;&#x57FA;&#x672C;&#x4E3A;&#x65E7;&#x7D22;&#x5F15;&#x5927;&#x5C0F;&#xFF0C;rebuild&#x6210;&#x529F;&#x540E;&#xFF0C;rebuild&#x8FC7;&#x7A0B;&#x5360;&#x7528;&#x7684;&#x989D;&#x5916;&#x7A7A;&#x95F4;&#x5C06;&#x4F1A;&#x88AB;&#x91CA;&#x653E;&#x3002;</li>
</ul>
</li>
</ul>
<h3 id="&#x65B9;&#x6CD5;3&#xFF1A;alter-index-rebuild-online">&#x65B9;&#x6CD5;3&#xFF1A;alter index rebuild online</h3>
<pre class="language-"><code>You have the option of rebuilding the index online. Rebuilding online enables you to update base tables at the same time that you are rebuilding. The following statement rebuilds the emp_name index online
</code></pre><ul>
<li>rebuild online&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;&#x57FA;&#x8868;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x589E;&#x5220;&#x6539;&#x7B49;DML&#x64CD;&#x4F5C;&#xFF0C;&#x5728;&#x7EBF;rebuild&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x4E86;&#x4E1A;&#x52A1;&#x8FDE;&#x7EED;&#x6027;&#xFF0C;&#x6BD4;rebuild&#x8981;&#x9AD8;&#x7EA7;&#x4E00;&#x4E9B;&#x3002;</li>
<li>rebuild online&#x7D22;&#x5F15;&#x91CD;&#x5EFA;&#x8FC7;&#x7A0B;&#x4E5F;&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x7A7A;&#x95F2;&#x7A7A;&#x95F4;&#xFF0C;&#x53E6;&#x5916;rebuild online&#x8FC7;&#x7A0B;&#x4E2D;&#x65E7;&#x7D22;&#x5F15;&#x4F9D;&#x7136;&#x53EF;&#x7528;&#x3002;</li>
<li>&#x548C;rebuild&#x4E0D;&#x540C;&#x7684;&#x4E00;&#x70B9;rebuild online&#x4EE5;&#x57FA;&#x8868;&#x4F5C;&#x4E3A;&#x57FA;&#x7840;&#x8FDB;&#x884C;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#xFF08;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;10046&#x786E;&#x8BA4;&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x76F8;&#x5BF9;rebuild&#x4F1A;&#x6162;&#x4E00;&#x4E9B;&#x3002;</li>
<li>&#x5728;rebuild online&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;oracle&#x4F1A;&#x81EA;&#x52A8;&#x7EF4;&#x62A4;&#x4E00;&#x65E5;&#x5FD7;(journal)&#x8868;,&#x901A;&#x8FC7;&#x9501;&#x4EE5;&#x53CA;dba_objects&#x89C6;&#x56FE;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#x53EF;&#x4EE5;&#x8DDF;&#x8E2A;&#x5230;&#x8BE5;&#x8868;&#x3002;<ul>
<li>&#x7531;&#x4E8E;&#x8981;&#x989D;&#x5916;&#x7EF4;&#x62A4;&#x4E00;&#x5F20;&#x65E5;&#x5FD7;&#x8868;&#xFF0C;&#x90A3;&#x4E48;&#x5982;&#x679C;&#x5728;rebuild online&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x57FA;&#x8868;&#x53D1;&#x751F;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x589E;&#x5220;&#x6539;&#x64CD;&#x4F5C;&#xFF0C;&#x6574;&#x4E2A;rebuild online&#x91CD;&#x5EFA;&#x7D22;&#x5F15;&#x8FC7;&#x7A0B;&#x5C31;&#x4F1A;&#x5F02;&#x5E38;&#x7684;&#x6162;&#x3002;</li>
<li>&#x53E6;&#x5916;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x7279;&#x522B;&#x91CD;&#x8981;&#x7684;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#xFF1A;&#x867D;&#x7136;rebuild index online&#x5728;&#x6267;&#x884C;&#x671F;&#x95F4;&#x4E0D;&#x4F1A;&#x963B;&#x585E;DML&#x64CD;&#x4F5C;&#xFF0C;&#x4F46;&#x5728;&#x5F00;&#x59CB;&#x548C;&#x7ED3;&#x675F;&#x9636;&#x6BB5;&#xFF0C;&#x9700;&#x8981;&#x8BF7;&#x6C42;&#x6A21;&#x5F0F;&#x4E3A;4&#x7684;TM&#x9501;&#x3002;&#x5982;&#x679C;&#x5728;rebuild index online&#x5F00;&#x59CB;&#x524D;&#x6216;&#x7ED3;&#x675F;&#x65F6;&#xFF0C;&#x6709;&#x5176;&#x5B83;&#x957F;&#x65F6;&#x95F4;&#x7684;&#x4E8B;&#x52A1;&#x5728;&#x8FD0;&#x884C;&#x4F1A;&#x963B;&#x585E;</li>
</ul>
</li>
</ul>
<h3 id="3&#x79CD;&#x65B9;&#x6CD5;&#x7684;&#x603B;&#x7ED3;">3&#x79CD;&#x65B9;&#x6CD5;&#x7684;&#x603B;&#x7ED3;</h3>
<ul>
<li>drop--&gt;create index,alter index rebulid&#x4F1A;&#x963B;&#x585E;&#x57FA;&#x8868;&#x7684;&#x589E;&#x5220;&#x6539;DML&#x64CD;&#x4F5C;&#xFF0C;alter index rebuild online&#x4E0D;&#x4F1A;&#x963B;&#x585E;&#xFF0C;&#x4FDD;&#x8BC1;&#x5728;&#x7EBF;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x3002;</li>
<li>alter index rebulid&#x4EE5;&#x53CA;rebuild online&#x91CD;&#x5EFA;&#x8FC7;&#x7A0B;&#x8981;&#x6C42;&#x6709;&#x989D;&#x5916;&#x7684;&#x7A7A;&#x95F2;&#x7A7A;&#x95F4;&#xFF0C;drop--&gt;create index&#x65E0;&#x6B64;&#x8981;&#x6C42;&#x3002;</li>
<li>&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;rebuild&#x901F;&#x5EA6;&#x6700;&#x5FEB;&#xFF0C;&#x9488;&#x5BF9;rebuild online&#x8BF7;&#x4FDD;&#x8BC1;&#x91CD;&#x5EFA;&#x5F00;&#x59CB;&#x524D;&#x4E0E;&#x7ED3;&#x675F;&#x524D;&#x65E0;&#x76F8;&#x5173;&#x4E8B;&#x52A1;&#xFF0C;&#x5426;&#x5219;&#x4F1A;rebuild online&#x4F1A;&#x4E00;&#x76F4;&#x5904;&#x4E8E;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x3002;</li>
<li>&#x4E0A;&#x8FF0;&#x4E09;&#x79CD;&#x91CD;&#x5EFA;&#x7D22;&#x5F15;&#x65B9;&#x6CD5;&#x5404;&#x6709;&#x5229;&#x5F0A;&#xFF0C;&#x5728;&#x5B9E;&#x9645;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;&#x5177;&#x4F53;&#x91C7;&#x7528;&#x54EA;&#x79CD;&#x65B9;&#x6CD5;&#x8BF7;&#x7ED3;&#x5408;&#x5177;&#x4F53;&#x60C5;&#x51B5;&#x914C;&#x60C5;&#x5904;&#x7406;&#x3002;</li>
<li>&#x521B;&#x5EFA;&#x7D22;&#x5F15;&#x7684;&#x8BED;&#x53E5;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x52A0;&#x5E76;&#x884C;&#x548C;nologging</li>
</ul>
<h2 id="&#x76F8;&#x5173;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;">&#x76F8;&#x5173;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;</h2>
<h3 id="&#x67E5;&#x8BE2;&#x7D22;&#x5F15;&#x788E;&#x7247;50&#x7684;&#x8BED;&#x53E5;">&#x67E5;&#x8BE2;&#x7D22;&#x5F15;&#x788E;&#x7247;&gt;50%&#x7684;&#x8BED;&#x53E5;</h3>
<pre class="language-"><code>col owner format a15;
col table_name format a30;
col index_name format a30;

select
  idx.owner owner,
  idx.table_name tablename,
  idx.index_name index_name,
  idx.blocks idx_blocks,
  tbl.blocks tbl_blocks,
  trunc(idx.blocks/tbl.blocks*100)/100 pct
from
  (select i.owner owner ,i.index_name index_name,SUM(S1.blocks) blocks,i.table_owner table_owner,
     i.table_name table_name
     from dba_segments s1,dba_indexes i
     where
      s1.owner=i.owner and s1.segment_name=i.index_name and
      i.owner not in (&apos;SYS&apos;,&apos;OUTLN&apos;,&apos;SYSTEM&apos;,&apos;MGMT_VIEW&apos;,&apos;SYSMAN&apos;,&apos;DBSNMP&apos;,&apos;WMSYS&apos;,&apos;XDB&apos;,
      &apos;DIP&apos;,&apos;GOLDENGATE&apos;,&apos;CTXSYS&apos; )
     GROUP BY i.owner ,i.index_name ,i.table_owner , i.table_name  ) idx,
  (select    t.owner owner ,t.table_name table_name,SUM(s2.blocks) blocks
     from dba_segments s2,dba_tables t
     where
      s2.owner=t.owner and s2.segment_name=t.table_name and
      t.owner not in (&apos;SYS&apos;,&apos;OUTLN&apos;,&apos;SYSTEM&apos;,&apos;MGMT_VIEW&apos;,&apos;SYSMAN&apos;,&apos;DBSNMP&apos;,&apos;WMSYS&apos;,&apos;XDB&apos;,
      &apos;DIP&apos;,&apos;GOLDENGATE&apos;,&apos;CTXSYS&apos; )
      GROUP BY  T.OWNER,T.TABLE_NAME
      ) tbl
where
    idx.table_owner=tbl.owner and
    idx.table_name=tbl.table_name and
    (idx.blocks/tbl.blocks)&gt;0.5 and
    idx.blocks&gt;200
    order by 4;
</code></pre><h3 id="&#x67E5;&#x8BE2;&#x7D22;&#x5F15;&#x9AD8;&#x5EA6;3">&#x67E5;&#x8BE2;&#x7D22;&#x5F15;&#x9AD8;&#x5EA6;&gt;3</h3>
<pre class="language-"><code> select owner,index_name,table_owner,table_name,BLEVEL from dba_indexes where blevel &gt; 3;
</code></pre><h2 id="&#x6CE8;&#x610F;&#x4E8B;&#x9879;&#x4E0E;&#x603B;&#x7ED3;">&#x6CE8;&#x610F;&#x4E8B;&#x9879;&#x4E0E;&#x603B;&#x7ED3;</h2>
<p>&#x751F;&#x4EA7;&#x7CFB;&#x7EDF;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x660E;&#x786E;&#x5982;&#x4E0B;&#x51E0;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x662F;&#x4E0D;&#x662F;&#x4E1A;&#x52A1;&#x65F6;&#x95F4;&#xFF08;&#x6216;&#x4E1A;&#x52A1;&#x9AD8;&#x5CF0;&#x671F;&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x662F;&#xFF0C;&#x5219;&#x5C3D;&#x91CF;&#x4E0D;&#x8981;&#x8FDB;&#x884C;&#x7C7B;&#x6B64;&#x64CD;&#x4F5C;&#x3002;&#x56E0;&#x4E3A;&#x5728;&#x5927;&#x5BF9;&#x8C61;&#x4E2D;&#x521B;&#x5EFA;&#x7D22;&#x5F15;&#x65F6;&#x4E0D;&#x4EC5;&#x9700;&#x8981;&#x8F83;&#x5927;temp&#x8868;&#x7A7A;&#x95F4;&#xFF0C;&#x800C;&#x4E14;&#x57FA;&#x4E8E;&#x8868;&#x539F;&#x6709;&#x7D22;&#x5F15;&#x7684;&#x6240;&#x6709;SQL&#x8BED;&#x53E5;&#x7684;&#x6267;&#x884C;&#x8BA1;&#x5212;&#x90FD;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x8FD9;&#x4E9B;SQL&#x7684;&#x91CD;&#x65B0;&#x89E3;&#x91CA;&#x9700;&#x8981;&#x5927;&#x91CF;CPU&#x8D44;&#x6E90;&#x3002;</li>
<li>&#x5F53;&#x539F;&#x6765;&#x7D22;&#x5F15;&#x88AB;&#x5220;&#x9664;&#x540E;&#xFF0C;&#x51FA;&#x73B0;&#x5927;&#x91CF;&#x7684;&#x5168;&#x8868;&#x626B;&#x63CF;&#x3002;&#x8FD9;&#x4E0D;&#x4EC5;&#x5BF9;&#x7CFB;&#x7EDF;I/O&#x4EA7;&#x751F;&#x538B;&#x529B;&#xFF0C;&#x800C;&#x4E14;buffer catch&#x4E2D;&#x7684;&#x5DF2;&#x7F13;&#x5B58;&#x6570;&#x636E;&#x5757;&#x5F88;&#x5BB9;&#x6613;&#x88AB;&#x6324;&#x51FA;&#x53BB;&#xFF0C;&#x4E0D;&#x4EC5;&#x5BF9;SGA&#x5E26;&#x6765;&#x538B;&#x529B;&#xFF0C;&#x800C;&#x4E14;&#x5BF9;I/O&#x4EA7;&#x751F;&#x6076;&#x6027;&#x5FAA;&#x73AF;&#x3002;</li>
<li>&#x7EFC;&#x5408;CPU&#x3001;&#x5185;&#x5B58;&#x3001;I/O&#x65B9;&#x9762;&#x8D44;&#x6E90;&#x7D27;&#x5F20;&#xFF0C;&#x5728;&#x52A0;&#x4E0A;&#x6B63;&#x5E38;&#x4E1A;&#x52A1;&#x529E;&#x7406;&#x9700;&#x8981;&#x7684;&#x5404;&#x7C7B;DML&#x64CD;&#x4F5C;&#xFF0C;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;<code>row lock contention&#x3001;read by other session</code>&#x7B49;&#x4E00;&#x5806;&#x7B49;&#x5F85;&#xFF0C;&#x6700;&#x7EC8;&#x7CFB;&#x7EDF;&#x88AB;&#x51FA;&#x73B0;&#x65E0;&#x6CD5;&#x529E;&#x7406;&#x4E1A;&#x52A1;&#x7684;&#x7B49;&#x5F85;&#xFF08;&#x7CFB;&#x7EDF;&#x6162;&#xFF09;&#x72B6;&#x6001;&#x3002;</li>
</ul>
<p>&#x56E0;&#x6B64;&#x5728;&#x8FDB;&#x884C;&#x91CD;&#x5EFA;&#x6216;&#x521B;&#x5EFA;&#x6240;&#x4EE5;&#x4E4B;&#x524D;&#xFF0C;&#x5F88;&#x6709;&#x5FC5;&#x8981;&#x5145;&#x5206;&#x8003;&#x8651;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x3001;&#x6570;&#x636E;&#x5E93;&#x5BF9;&#x8C61;&#x7684;&#x5927;&#x5C0F;&#x548C;&#x7528;&#x9014;&#x3001;temp&#x8868;&#x7A7A;&#x95F4;&#x5927;&#x5C0F;&#xFF0C;&#x786C;&#x4EF6;&#x8D44;&#x6E90;&#x3001;&#x56DE;&#x9000;&#x65B9;&#x6848;&#x7B49;&#x7B49;&#x3002;</p>
<p>&#x6CE8;:rebuild&#x548C;rebuild online&#x7684;&#x533A;&#x522B;</p>
<ul>
<li>&#x5F53;rebuild &#x65F6;&#x4E00;&#x822C;&#x5BF9;&#x539F;&#x5148;&#x7D22;&#x5F15;&#x8FDB;&#x884C;INDEX FAST FULL SCAN&#x3002;</li>
<li>&#x5F53;rebuild online&#x7684;&#x65F6;&#x4E0D;&#x7528;&#x539F;&#x5148;&#x7D22;&#x5F15;&#x800C;&#x6267;&#x884C;TABLE ACCESS FULL</li>
<li>rebuild&#x548C;rebuild online&#x90FD;&#x4F1A;&#x53D1;&#x751F;sort&#xFF0C;&#x5373;&#x9700;&#x8981;&#x7528;&#x5230;temp&#x8868;&#x7A7A;&#x95F4;&#x3002;</li>
<li>rebuild &#x4F1A;&#x963B;&#x585E;dml&#x8BED;&#x53E5;&#x800C;rebuild online&#x5219;&#x4E0D;&#x4F1A;&#x3002;</li>
<li>rebuild online&#x65F6;&#x7CFB;&#x7EDF;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;SYS_JOURNAL_xxx&#x7684;IOT&#x7C7B;&#x578B;&#x7684;&#x7CFB;&#x7EDF;&#x4E34;&#x65F6;&#x65E5;&#x5FD7;&#x8868;&#xFF0C;&#x6240;&#x6709;rebuild online&#x65F6;&#x7D22;&#x5F15;&#x7684;&#x53D8;&#x5316;&#x90FD;&#x8BB0;&#x5F55;&#x5728;&#x8FD9;&#x4E2A;&#x8868;&#x4E2D;&#xFF0C;&#x5F53;&#x65B0;&#x7684;&#x7D22;&#x5F15;&#x521B;&#x5EFA;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x628A;&#x8FD9;&#x4E2A;&#x8868;&#x7684;&#x8BB0;&#x5F55;&#x7EF4;&#x62A4;&#x5230;&#x65B0;&#x7684;&#x7D22;&#x5F15;&#x4E2D;&#x53BB;&#xFF0C;&#x7136;&#x540E;drop&#x6389;&#x65E7;&#x7684;&#x7D22;&#x5F15;&#xFF0C;rebuild online&#x5C31;&#x5B8C;&#x6210;&#x4E86;&#x3002;</li>
</ul>
<h2 id="&#x53C2;&#x8003;&#x6587;&#x6863;">&#x53C2;&#x8003;&#x6587;&#x6863;</h2>
<blockquote>
<p>[1]&#x53C2;&#x8003;&#x5B98;&#x65B9;&#x6587;&#x6863;: <a href="https://docs.oracle.com/cd/E11882_01/server.112/e25494/indexes.htm#ADMIN13283" target="_blank">Managing Indexes</a></p>
<p>[2]&#x53C2;&#x8003;metalink Note:272762.1</p>
</blockquote>
<pre class="language-"><code>========
- Online Index rebuild takes a long time.
- ONLINE INDEX REBUILD SCANS THE BASE TABLE AND NOT THE INDEX
Symptoms:
=========
Performance issues while rebuilding very large indexes.
- The offline rebuilds of their index is relatively quick -finishes in 15 minutes.
- Issuing index rebuild ONLINE statement =&gt; finishes in about an hour.
- This behavior of ONLINE index rebuilds makes it a non-option for large tables
as it just takes too long to scan the table to rebuild the index. The offline may not be feasible due to due to the 24/7 nature of the database.
- This may be a loss of functionality for such situations.
- If we attempt to simultaneously ONLINE rebuild the same indexes we may encounter hanging behavior indefinitely (or more than 6 hours).


DIAGNOSTICANALYSIS:

--------------------
We can trace the sessions rebuilding the indexes with 10046 level 12.
Comparing the IO reads for the index-rebuild and the index-rebuild-onlinereveals the following:
-ONLINE indexrebuilds
It scans thebase table and it doesn&apos;t scan the blocks of the index.



-OFFLINE index rebuilds
It scans the index for the build operation.

- This behaviour is across all versions.



Cause
Cause/Explanation
=============
When you rebuild index online,

- it will do a full tablescan on thebase table.

- At the same time it will maintaina journal table for DML data, which has changed during this index rebuildingoperation.

So it shouldtake longer time, specially if you do lots of DML on the same table,whilerebuilding index online.
On the other hand, while rebuilding the index without online option, Oraclewill grab the index in X-mode and rebuild a new index segment by selecting thedata from the old index. So here we are
- not allowing any DML on the table hence there is nojournal table involved
- and it is doing an index scan
Hence it will be pretty fast.
Fix
Solution/Conclusion:
===========
- The ONLINE index rebuild reads the base table, and this is by design.
- Rebuilding index ONLINE is pretty slow.
- Rebuilding index offline is very fast, but it prevents any DML on the basetable.
</code></pre><footer class="page-footer"><span class="copyright">Copyright &#xA9; suredandan 2018 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">UpdateTime: 
2019-01-24 10:27:19
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="37.表碎片分析.html" class="navigation navigation-prev " aria-label="Previous page: 表碎片分析与整理">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="query-yincang-parameter.html" class="navigation navigation-next " aria-label="Next page: 查看隐藏参数">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"索引碎片分析与整理","level":"1.7.16","depth":2,"next":{"title":"查看隐藏参数","level":"1.7.17","depth":2,"path":"manage/query-yincang-parameter.md","ref":"manage/query-yincang-parameter.md","articles":[]},"previous":{"title":"表碎片分析与整理","level":"1.7.15","depth":2,"path":"manage/37.表碎片分析.md","ref":"manage/37.表碎片分析.md","articles":[]},"dir":"ltr"},"config":{"plugins":["prism","prism-themes","-highlight","codesnippet","splitter","simple-page-toc","page-toc-button","back-to-top-button","-lunr","-search","search-plus","favicon@^0.0.2","tbfed-pagefooter@^0.0.1","theme-default","sitemap-general"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright © suredandan 2018","modify_label":"UpdateTime: ","modify_format":"YYYY-MM-DD HH:mm:ss"},"prism":{"css":["prismjs/themes/prism-solarizedlight.css"]},"simple-page-toc":{"maxDepth":3,"skipFirstH1":true},"splitter":{},"codesnippet":{},"sitemap-general":{"prefix":"http://www.googlebaba.io/oracle/"},"fontsettings":{"theme":"white","family":"sans","size":2},"favicon":{"shortcut":"favicon.ico","bookmark":"favicon.ico"},"page-toc-button":{},"back-to-top-button":{},"prism-themes":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"showLevel":true,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"search-plus":{},"image-captions":{"caption":"_CAPTION_"}},"theme":"default","author":"suredandan","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"中年人的Oracle枸杞","language":"zh-hans","gitbook":"*","description":"记录日常的一些Oracle实施文档"},"file":{"path":"manage/38.索引碎片分析.md","mtime":"2019-01-24T02:27:19.053Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-06-10T14:25:54.612Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

